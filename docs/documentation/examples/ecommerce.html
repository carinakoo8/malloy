---
layout: documentation
title: Malloy Documentation
footer: /generated/footers/examples/ecommerce.html
---

<div class="document">
      <h1>
        <a id="ecommerce-walkthrough-an-intro-to-malloy-syntax-the-vscode-plugin" class="header-link anchor" href="#ecommerce-walkthrough-an-intro-to-malloy-syntax-the-vscode-plugin">
          eCommerce Walkthrough: An Intro to Malloy Syntax & the VSCode Plugin
        </a>
      </h1>
    <p><em>The following walk-through covers similar concepts to the <a href="https://github.com/looker-open-source/malloy/#quick-start-videos">Quick Start</a> videos in the README. You can find the complete source code for this model <a href="https://github.com/looker-open-source/malloy/blob/docs-release/samples/ecommerce/ecommerce.malloy">here</a>.</em></p>
<p>Malloy queries compile to SQL. As Malloy queries become more complex, the SQL complexity expands dramatically, while the Malloy query remains concise and easier to read.</p>
<p>Let’s illustrate this by asking a straightforward question of a simple ecommerce dataset--how many order items have we sold, broken down by their current status?</p>
<pre class="language-malloy"><span class="token keyword">query</span>: <span class="token function">table</span><span class="token punctuation">(</span><span class="token string">'malloy-data.ecomm.order_items'</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> {
  <span class="token keyword">group_by</span>: status
  <span class="token keyword">aggregate</span>: order_item_count <span class="token keyword">is</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
}</pre><div class="result-outer large">
    <div class="result-controls-bar">
      <span class="result-label">QUERY RESULTS</span>
      <div class="result-controls">
        <button class="result-control" selected data-result-kind="html">HTML</button>
        <button class="result-control"  data-result-kind="json">JSON</button>
        <button class="result-control"  data-result-kind="sql">SQL</button>
      </div>
    </div>
    <div class="result-middle" data-result-kind="html" selected>
      <div class="result-inner">
        <table style="border: 1px solid #eaeaea; vertical-align: top; border-bottom: 1px solid #eaeaea; border-collapse: collapse; width: 100%;">
		<thead>
			<tr>
				<th style="padding: 8px; color: #505050; border-bottom: 1px solid #eaeaea; text-align: left;">status</th>
<th style="padding: 8px; color: #505050; border-bottom: 1px solid #eaeaea; text-align: right;">order_&#8203;item_&#8203;count</th>
      </tr>
		</thead>
		<tbody>
			<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Complete</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">221,175</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Cancelled</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">8,268</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Returned</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">2,261</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Shipped</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">1,482</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Processing</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">862</td>
</tr>

		</tbody>
	</table>
      </div>
    </div>
    <div class="result-middle" data-result-kind="json" >
      <div class="result-inner">
        <pre><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token property">"status"</span><span class="token operator">:</span> <span class="token string">"Complete"</span><span class="token punctuation">,</span>
    <span class="token property">"order_item_count"</span><span class="token operator">:</span> <span class="token number">221175</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"status"</span><span class="token operator">:</span> <span class="token string">"Cancelled"</span><span class="token punctuation">,</span>
    <span class="token property">"order_item_count"</span><span class="token operator">:</span> <span class="token number">8268</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"status"</span><span class="token operator">:</span> <span class="token string">"Returned"</span><span class="token punctuation">,</span>
    <span class="token property">"order_item_count"</span><span class="token operator">:</span> <span class="token number">2261</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"status"</span><span class="token operator">:</span> <span class="token string">"Shipped"</span><span class="token punctuation">,</span>
    <span class="token property">"order_item_count"</span><span class="token operator">:</span> <span class="token number">1482</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"status"</span><span class="token operator">:</span> <span class="token string">"Processing"</span><span class="token punctuation">,</span>
    <span class="token property">"order_item_count"</span><span class="token operator">:</span> <span class="token number">862</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span></pre>
      </div>
    </div>
    <div class="result-middle" data-result-kind="sql" >
      <div class="result-inner">
        <pre><span class="token keyword">SELECT</span> 
   base<span class="token punctuation">.</span><span class="token keyword">status</span> <span class="token keyword">as</span> <span class="token keyword">status</span><span class="token punctuation">,</span>
   <span class="token function">COUNT</span><span class="token punctuation">(</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">as</span> order_item_count
<span class="token keyword">FROM</span> <span class="token punctuation">`</span>malloy<span class="token operator">-</span><span class="token keyword">data</span><span class="token punctuation">.</span>ecomm<span class="token punctuation">.</span>order_items<span class="token punctuation">`</span> <span class="token keyword">as</span> base
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token number">1</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token number">2</span> <span class="token keyword">desc</span>
</pre>
      </div>
    </div>
  </div><p>The use of <code class="language-malloy"><span class="token keyword">group_by</span></code> in the above query invokes a <code class="language-malloy">SELECT</code> with a <code class="language-malloy">GROUP <span class="token keyword">BY</span></code> in SQL. Malloy also has a <code class="language-malloy"><span class="token keyword">project</span></code> transformation, which will <code class="language-malloy">SELECT</code> without a <code class="language-malloy">GROUP <span class="token keyword">BY</span></code>.</p>
<p>Notice that after you write this, small "Run | Render" code lens will appear above the query. Run will show the JSON result, while Render will show a table by default, or a visualization if you've configured one (more on this later). Click the code lens to run the query. This will produce the following SQL:</p>
<pre class="language-sql"><span class="token keyword">SELECT</span>
  base<span class="token punctuation">.</span><span class="token keyword">status</span> <span class="token keyword">as</span> <span class="token keyword">status</span><span class="token punctuation">,</span>
  <span class="token function">COUNT</span><span class="token punctuation">(</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">as</span> order_item_count
<span class="token keyword">FROM</span> malloy<span class="token operator">-</span><span class="token keyword">data</span><span class="token punctuation">.</span>ecomm<span class="token punctuation">.</span>order_items <span class="token keyword">as</span> base
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token number">1</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token number">2</span> <span class="token keyword">desc</span></pre><p><em>Note: To see the SQL being generated by your query, open up a New Terminal in the top menu, then select Output, and pick “Malloy” from the menu on the right.</em></p>
<p><img src="https://user-images.githubusercontent.com/7178946/130125702-7049299a-fe0f-4f50-aaed-1c9016835da7.gif" alt="Kapture 2021-08-18 at 17 07 03"/></p>
<p>Next question: In 2020, how much did we sell to users in each state? This requires filtering to the year 2020, excluding cancelled and returned orders, as well as joining in the users table.</p>
<pre class="language-malloy"><span class="token keyword">query</span>: <span class="token function">table</span><span class="token punctuation">(</span><span class="token string">'malloy-data.ecomm.order_items'</span><span class="token punctuation">)</span>{
  <span class="token keyword">join_one</span>: users <span class="token keyword">is</span> <span class="token function">table</span><span class="token punctuation">(</span><span class="token string">'malloy-data.ecomm.users'</span><span class="token punctuation">)</span> <span class="token keyword">on</span> user_id <span class="token operator">=</span> users<span class="token punctuation">.</span>id
}
<span class="token operator">-</span><span class="token operator">></span> {
  <span class="token keyword">where</span>: <span class="token punctuation">[</span>
    created_at: <span class="token date">@2020</span>
    <span class="token punctuation">,</span> status <span class="token operator">!=</span> <span class="token string">'Cancelled'</span> <span class="token operator">&amp;</span> <span class="token operator">!=</span> <span class="token string">'Returned'</span><span class="token punctuation">]</span>
  <span class="token keyword">group_by</span>: users<span class="token punctuation">.</span>state
  <span class="token keyword">aggregate</span>: total_sales <span class="token keyword">is</span> sale_price<span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
}</pre><div class="result-outer large">
    <div class="result-controls-bar">
      <span class="result-label">QUERY RESULTS</span>
      <div class="result-controls">
        <button class="result-control" selected data-result-kind="html">HTML</button>
        <button class="result-control"  data-result-kind="json">JSON</button>
        <button class="result-control"  data-result-kind="sql">SQL</button>
      </div>
    </div>
    <div class="result-middle" data-result-kind="html" selected>
      <div class="result-inner">
        <table style="border: 1px solid #eaeaea; vertical-align: top; border-bottom: 1px solid #eaeaea; border-collapse: collapse; width: 100%;">
		<thead>
			<tr>
				<th style="padding: 8px; color: #505050; border-bottom: 1px solid #eaeaea; text-align: left;">state</th>
<th style="padding: 8px; color: #505050; border-bottom: 1px solid #eaeaea; text-align: right;">total_&#8203;sales</th>
      </tr>
		</thead>
		<tbody>
			<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">California</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">536,674.782</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Texas</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">315,770.551</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">New York</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">214,908.191</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Illinois</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">178,621.471</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Florida</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">131,839.151</td>
</tr>

		</tbody>
	</table>
      </div>
    </div>
    <div class="result-middle" data-result-kind="json" >
      <div class="result-inner">
        <pre><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token property">"state"</span><span class="token operator">:</span> <span class="token string">"California"</span><span class="token punctuation">,</span>
    <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">536674.7821646929</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"state"</span><span class="token operator">:</span> <span class="token string">"Texas"</span><span class="token punctuation">,</span>
    <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">315770.551210165</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"state"</span><span class="token operator">:</span> <span class="token string">"New York"</span><span class="token punctuation">,</span>
    <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">214908.1908490844</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"state"</span><span class="token operator">:</span> <span class="token string">"Illinois"</span><span class="token punctuation">,</span>
    <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">178621.4707119465</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"state"</span><span class="token operator">:</span> <span class="token string">"Florida"</span><span class="token punctuation">,</span>
    <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">131839.15053749084</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span></pre>
      </div>
    </div>
    <div class="result-middle" data-result-kind="sql" >
      <div class="result-inner">
        <pre><span class="token keyword">SELECT</span> 
   users_0<span class="token punctuation">.</span>state <span class="token keyword">as</span> state<span class="token punctuation">,</span>
   <span class="token function">SUM</span><span class="token punctuation">(</span>base<span class="token punctuation">.</span>sale_price<span class="token punctuation">)</span> <span class="token keyword">as</span> total_sales
<span class="token keyword">FROM</span> <span class="token punctuation">`</span>malloy<span class="token operator">-</span><span class="token keyword">data</span><span class="token punctuation">.</span>ecomm<span class="token punctuation">.</span>order_items<span class="token punctuation">`</span> <span class="token keyword">as</span> base
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> <span class="token punctuation">`</span>malloy<span class="token operator">-</span><span class="token keyword">data</span><span class="token punctuation">.</span>ecomm<span class="token punctuation">.</span>users<span class="token punctuation">`</span> <span class="token keyword">AS</span> users_0 <span class="token keyword">ON</span> base<span class="token punctuation">.</span>user_id<span class="token operator">=</span>users_0<span class="token punctuation">.</span>id
<span class="token keyword">WHERE</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>base<span class="token punctuation">.</span>created_at<span class="token operator">>=</span><span class="token string">'2020-01-01'</span><span class="token punctuation">)</span><span class="token operator">and</span><span class="token punctuation">(</span>base<span class="token punctuation">.</span>created_at<span class="token operator">&lt;</span><span class="token string">'2021-01-01'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">AND</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>IFNULL<span class="token punctuation">(</span><span class="token operator">NOT</span><span class="token punctuation">(</span>base<span class="token punctuation">.</span><span class="token keyword">status</span><span class="token operator">=</span><span class="token string">'Cancelled'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">and</span><span class="token punctuation">(</span>IFNULL<span class="token punctuation">(</span><span class="token operator">NOT</span><span class="token punctuation">(</span>base<span class="token punctuation">.</span><span class="token keyword">status</span><span class="token operator">=</span><span class="token string">'Returned'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token number">1</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token number">2</span> <span class="token keyword">desc</span>
</pre>
      </div>
    </div>
  </div><p>At this point we might notice we’re defining a few things we might like to re-use, so let’s add them to the model:</p>
<pre class="language-malloy"><span class="token keyword">explore</span>: users <span class="token keyword">is</span> <span class="token function">table</span><span class="token punctuation">(</span><span class="token string">'malloy-data.ecomm.users'</span><span class="token punctuation">)</span>{
  <span class="token keyword">primary_key</span>: id
}

<span class="token keyword">explore</span>: order_items <span class="token keyword">is</span> <span class="token function">table</span><span class="token punctuation">(</span><span class="token string">'malloy-data.ecomm.order_items'</span><span class="token punctuation">)</span>{
  <span class="token keyword">primary_key</span>: id
  <span class="token keyword">join_one</span>: users <span class="token keyword">with</span> user_id
  <span class="token keyword">measure</span>: <span class="token punctuation">[</span>
    total_sales <span class="token keyword">is</span> sale_price<span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    order_count <span class="token keyword">is</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token function_keyword">distinct</span> order_id<span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
}</pre><p>Having defined this in the model, the VSCode plugin will give us handy "Outline" and "Schema" tools in the left menu. "Outline" provides an interactive navigator of the model, in order, and "Schema" shows all of the attributes (both raw fields in the underlying table, and the dimensions, measures, and named queries you've defined in your model).</p>
<img width="281" alt="Screen Shot 2021-08-27 at 4 21 15 PM" src="https://user-images.githubusercontent.com/7178946/131198480-28410cb0-9482-40b4-bc6f-5d67ecdeda2a.png"><p>Our query is now very simple:</p>
<pre class="language-malloy"><span class="token keyword">query</span>: sales_by_state_2020 <span class="token keyword">is</span> order_items {<span class="token keyword">where</span>: created_at: <span class="token date">@2020</span>} <span class="token operator">-</span><span class="token operator">></span> {
  <span class="token keyword">group_by</span>: users<span class="token punctuation">.</span>state
  <span class="token keyword">aggregate</span>: total_sales
}</pre><div class="result-outer large">
    <div class="result-controls-bar">
      <span class="result-label">QUERY RESULTS</span>
      <div class="result-controls">
        <button class="result-control" selected data-result-kind="html">HTML</button>
        <button class="result-control"  data-result-kind="json">JSON</button>
        <button class="result-control"  data-result-kind="sql">SQL</button>
      </div>
    </div>
    <div class="result-middle" data-result-kind="html" selected>
      <div class="result-inner">
        <table style="border: 1px solid #eaeaea; vertical-align: top; border-bottom: 1px solid #eaeaea; border-collapse: collapse; width: 100%;">
		<thead>
			<tr>
				<th style="padding: 8px; color: #505050; border-bottom: 1px solid #eaeaea; text-align: left;">state</th>
<th style="padding: 8px; color: #505050; border-bottom: 1px solid #eaeaea; text-align: right;">total_&#8203;sales</th>
      </tr>
		</thead>
		<tbody>
			<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">California</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">561,080.732</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Texas</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">330,723.271</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">New York</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">224,256.631</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Illinois</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">185,573.601</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Florida</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">137,869.361</td>
</tr>

		</tbody>
	</table>
      </div>
    </div>
    <div class="result-middle" data-result-kind="json" >
      <div class="result-inner">
        <pre><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token property">"state"</span><span class="token operator">:</span> <span class="token string">"California"</span><span class="token punctuation">,</span>
    <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">561080.7323037386</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"state"</span><span class="token operator">:</span> <span class="token string">"Texas"</span><span class="token punctuation">,</span>
    <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">330723.27126312256</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"state"</span><span class="token operator">:</span> <span class="token string">"New York"</span><span class="token punctuation">,</span>
    <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">224256.63089038804</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"state"</span><span class="token operator">:</span> <span class="token string">"Illinois"</span><span class="token punctuation">,</span>
    <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">185573.6007373333</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"state"</span><span class="token operator">:</span> <span class="token string">"Florida"</span><span class="token punctuation">,</span>
    <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">137869.36056947708</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span></pre>
      </div>
    </div>
    <div class="result-middle" data-result-kind="sql" >
      <div class="result-inner">
        <pre><span class="token keyword">SELECT</span> 
   users_0<span class="token punctuation">.</span>state <span class="token keyword">as</span> state<span class="token punctuation">,</span>
   <span class="token function">SUM</span><span class="token punctuation">(</span>order_items<span class="token punctuation">.</span>sale_price<span class="token punctuation">)</span> <span class="token keyword">as</span> total_sales
<span class="token keyword">FROM</span> <span class="token punctuation">`</span>malloy<span class="token operator">-</span><span class="token keyword">data</span><span class="token punctuation">.</span>ecomm<span class="token punctuation">.</span>order_items<span class="token punctuation">`</span> <span class="token keyword">as</span> order_items
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> <span class="token punctuation">`</span>malloy<span class="token operator">-</span><span class="token keyword">data</span><span class="token punctuation">.</span>ecomm<span class="token punctuation">.</span>users<span class="token punctuation">`</span> <span class="token keyword">AS</span> users_0 <span class="token keyword">ON</span> order_items<span class="token punctuation">.</span>user_id <span class="token operator">=</span> users_0<span class="token punctuation">.</span>id
<span class="token keyword">WHERE</span> <span class="token punctuation">(</span>order_items<span class="token punctuation">.</span>created_at<span class="token operator">>=</span><span class="token string">'2020-01-01'</span><span class="token punctuation">)</span><span class="token operator">and</span><span class="token punctuation">(</span>order_items<span class="token punctuation">.</span>created_at<span class="token operator">&lt;</span><span class="token string">'2021-01-01'</span><span class="token punctuation">)</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token number">1</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token number">2</span> <span class="token keyword">desc</span>
</pre>
      </div>
    </div>
  </div><p>To further simplify, we can add this and a couple other queries we’ll frequently use to our model. Once you define these, the VSCode plugin will supply a “Run” button next to each query:</p>
<pre class="language-malloy">  <span class="token keyword">query</span>: sales_by_state_2020 <span class="token keyword">is</span> {
    <span class="token keyword">where</span>: created_at: <span class="token date">@2020</span>
    <span class="token keyword">group_by</span>: users<span class="token punctuation">.</span>state
    <span class="token keyword">aggregate</span>: total_sales
  }

  <span class="token keyword">query</span>: orders_by_status <span class="token keyword">is</span> {
    <span class="token keyword">group_by</span>: status
    <span class="token keyword">aggregate</span>: order_count
  }

  <span class="token keyword">query</span>: sales_by_month_2020 <span class="token keyword">is</span> {
    <span class="token keyword">group_by</span>: order_month <span class="token keyword">is</span> created_at<span class="token punctuation">.</span><span class="token timeframe">month</span>
    <span class="token keyword">aggregate</span>: total_sales
  }</pre><p>Allowing us to run the following very simple command next time we want to run any of these queries:</p>
<pre class="language-malloy"><span class="token keyword">query</span>: order_items <span class="token operator">-</span><span class="token operator">></span> sales_by_state_2020</pre><div class="result-outer large">
    <div class="result-controls-bar">
      <span class="result-label">QUERY RESULTS</span>
      <div class="result-controls">
        <button class="result-control" selected data-result-kind="html">HTML</button>
        <button class="result-control"  data-result-kind="json">JSON</button>
        <button class="result-control"  data-result-kind="sql">SQL</button>
      </div>
    </div>
    <div class="result-middle" data-result-kind="html" selected>
      <div class="result-inner">
        <table style="border: 1px solid #eaeaea; vertical-align: top; border-bottom: 1px solid #eaeaea; border-collapse: collapse; width: 100%;">
		<thead>
			<tr>
				<th style="padding: 8px; color: #505050; border-bottom: 1px solid #eaeaea; text-align: left;">state</th>
<th style="padding: 8px; color: #505050; border-bottom: 1px solid #eaeaea; text-align: right;">total_&#8203;sales</th>
      </tr>
		</thead>
		<tbody>
			<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">California</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">561,080.732</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Texas</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">330,723.271</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">New York</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">224,256.631</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Illinois</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">185,573.601</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Florida</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">137,869.361</td>
</tr>

		</tbody>
	</table>
      </div>
    </div>
    <div class="result-middle" data-result-kind="json" >
      <div class="result-inner">
        <pre><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token property">"state"</span><span class="token operator">:</span> <span class="token string">"California"</span><span class="token punctuation">,</span>
    <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">561080.7323037386</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"state"</span><span class="token operator">:</span> <span class="token string">"Texas"</span><span class="token punctuation">,</span>
    <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">330723.27126312256</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"state"</span><span class="token operator">:</span> <span class="token string">"New York"</span><span class="token punctuation">,</span>
    <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">224256.63089038804</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"state"</span><span class="token operator">:</span> <span class="token string">"Illinois"</span><span class="token punctuation">,</span>
    <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">185573.6007373333</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"state"</span><span class="token operator">:</span> <span class="token string">"Florida"</span><span class="token punctuation">,</span>
    <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">137869.36056947708</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span></pre>
      </div>
    </div>
    <div class="result-middle" data-result-kind="sql" >
      <div class="result-inner">
        <pre><span class="token keyword">SELECT</span> 
   users_0<span class="token punctuation">.</span>state <span class="token keyword">as</span> state<span class="token punctuation">,</span>
   <span class="token function">SUM</span><span class="token punctuation">(</span>order_items<span class="token punctuation">.</span>sale_price<span class="token punctuation">)</span> <span class="token keyword">as</span> total_sales
<span class="token keyword">FROM</span> <span class="token punctuation">`</span>malloy<span class="token operator">-</span><span class="token keyword">data</span><span class="token punctuation">.</span>ecomm<span class="token punctuation">.</span>order_items<span class="token punctuation">`</span> <span class="token keyword">as</span> order_items
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> <span class="token punctuation">`</span>malloy<span class="token operator">-</span><span class="token keyword">data</span><span class="token punctuation">.</span>ecomm<span class="token punctuation">.</span>users<span class="token punctuation">`</span> <span class="token keyword">AS</span> users_0 <span class="token keyword">ON</span> order_items<span class="token punctuation">.</span>user_id <span class="token operator">=</span> users_0<span class="token punctuation">.</span>id
<span class="token keyword">WHERE</span> <span class="token punctuation">(</span>order_items<span class="token punctuation">.</span>created_at<span class="token operator">>=</span><span class="token string">'2020-01-01'</span><span class="token punctuation">)</span><span class="token operator">and</span><span class="token punctuation">(</span>order_items<span class="token punctuation">.</span>created_at<span class="token operator">&lt;</span><span class="token string">'2021-01-01'</span><span class="token punctuation">)</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token number">1</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token number">2</span> <span class="token keyword">desc</span>
</pre>
      </div>
    </div>
  </div><p>Note that queries can be filtered at any level, by inserting filter expressions between square brackets. A filter after an explore applies to the whole explore; one before the fields in a <code class="language-malloy"><span class="token keyword">reduce</span></code> or <code class="language-malloy"><span class="token keyword">project</span></code> transformation applies to that transformation; and one after an aggregate field applies to that aggregate only. See filters documentation for more information on filter expressions. Here's an example with a variety of filter usage:</p>
<pre class="language-malloy"><span class="token keyword">query</span>: order_items {
  <span class="token keyword">where</span>: <span class="token punctuation">[</span>
    users<span class="token punctuation">.</span>state: <span class="token string">'California'</span> <span class="token operator">|</span> <span class="token string">'New York'</span> <span class="token operator">|</span> <span class="token string">'Texas'</span><span class="token punctuation">,</span>
     status: <span class="token operator">!=</span> <span class="token string">'Cancelled'</span> <span class="token operator">&amp;</span> <span class="token operator">!=</span> <span class="token string">'Processing'</span>
  <span class="token punctuation">]</span>
} <span class="token operator">-</span><span class="token operator">></span> {
  <span class="token keyword">group_by</span>: users<span class="token punctuation">.</span>state
  <span class="token keyword">aggregate</span>: <span class="token punctuation">[</span>
    total_sale_price_2020 <span class="token keyword">is</span> sale_price<span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> {<span class="token keyword">where</span>: created_at : <span class="token date">@2020</span>}<span class="token punctuation">,</span>
    percent_items_returned <span class="token keyword">is</span> <span class="token number">100.0</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span> {<span class="token keyword">where</span>: status : <span class="token string">'Returned'</span>}<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
}</pre><div class="result-outer large">
    <div class="result-controls-bar">
      <span class="result-label">QUERY RESULTS</span>
      <div class="result-controls">
        <button class="result-control" selected data-result-kind="html">HTML</button>
        <button class="result-control"  data-result-kind="json">JSON</button>
        <button class="result-control"  data-result-kind="sql">SQL</button>
      </div>
    </div>
    <div class="result-middle" data-result-kind="html" selected>
      <div class="result-inner">
        <table style="border: 1px solid #eaeaea; vertical-align: top; border-bottom: 1px solid #eaeaea; border-collapse: collapse; width: 100%;">
		<thead>
			<tr>
				<th style="padding: 8px; color: #505050; border-bottom: 1px solid #eaeaea; text-align: left;">state</th>
<th style="padding: 8px; color: #505050; border-bottom: 1px solid #eaeaea; text-align: right;">total_&#8203;sale_&#8203;price_&#8203;2020</th>
<th style="padding: 8px; color: #505050; border-bottom: 1px solid #eaeaea; text-align: right;">percent_&#8203;items_&#8203;returned</th>
      </tr>
		</thead>
		<tbody>
			<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">California</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">541,953.732</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">1.012</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Texas</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">318,803.821</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">1.084</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">New York</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">216,558.841</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">1.035</td>
</tr>

		</tbody>
	</table>
      </div>
    </div>
    <div class="result-middle" data-result-kind="json" >
      <div class="result-inner">
        <pre><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token property">"state"</span><span class="token operator">:</span> <span class="token string">"California"</span><span class="token punctuation">,</span>
    <span class="token property">"total_sale_price_2020"</span><span class="token operator">:</span> <span class="token number">541953.7321833372</span><span class="token punctuation">,</span>
    <span class="token property">"percent_items_returned"</span><span class="token operator">:</span> <span class="token number">1.0120256129939091</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"state"</span><span class="token operator">:</span> <span class="token string">"Texas"</span><span class="token punctuation">,</span>
    <span class="token property">"total_sale_price_2020"</span><span class="token operator">:</span> <span class="token number">318803.82123184204</span><span class="token punctuation">,</span>
    <span class="token property">"percent_items_returned"</span><span class="token operator">:</span> <span class="token number">1.0844629822732013</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"state"</span><span class="token operator">:</span> <span class="token string">"New York"</span><span class="token punctuation">,</span>
    <span class="token property">"total_sale_price_2020"</span><span class="token operator">:</span> <span class="token number">216558.84085514024</span><span class="token punctuation">,</span>
    <span class="token property">"percent_items_returned"</span><span class="token operator">:</span> <span class="token number">1.0345352198387343</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span></pre>
      </div>
    </div>
    <div class="result-middle" data-result-kind="sql" >
      <div class="result-inner">
        <pre><span class="token keyword">SELECT</span> 
   users_0<span class="token punctuation">.</span>state <span class="token keyword">as</span> state<span class="token punctuation">,</span>
   <span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> <span class="token punctuation">(</span>order_items<span class="token punctuation">.</span>created_at<span class="token operator">>=</span><span class="token string">'2020-01-01'</span><span class="token punctuation">)</span><span class="token operator">and</span><span class="token punctuation">(</span>order_items<span class="token punctuation">.</span>created_at<span class="token operator">&lt;</span><span class="token string">'2021-01-01'</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> order_items<span class="token punctuation">.</span>sale_price <span class="token keyword">END</span><span class="token punctuation">)</span> <span class="token keyword">as</span> total_sale_price_2020<span class="token punctuation">,</span>
   <span class="token punctuation">(</span><span class="token number">100.0</span><span class="token operator">*</span><span class="token function">COUNT</span><span class="token punctuation">(</span> <span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> order_items<span class="token punctuation">.</span><span class="token keyword">status</span><span class="token operator">=</span><span class="token string">'Returned'</span> <span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">END</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">COUNT</span><span class="token punctuation">(</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">as</span> percent_items_returned
<span class="token keyword">FROM</span> <span class="token punctuation">`</span>malloy<span class="token operator">-</span><span class="token keyword">data</span><span class="token punctuation">.</span>ecomm<span class="token punctuation">.</span>order_items<span class="token punctuation">`</span> <span class="token keyword">as</span> order_items
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> <span class="token punctuation">`</span>malloy<span class="token operator">-</span><span class="token keyword">data</span><span class="token punctuation">.</span>ecomm<span class="token punctuation">.</span>users<span class="token punctuation">`</span> <span class="token keyword">AS</span> users_0 <span class="token keyword">ON</span> order_items<span class="token punctuation">.</span>user_id <span class="token operator">=</span> users_0<span class="token punctuation">.</span>id
<span class="token keyword">WHERE</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>users_0<span class="token punctuation">.</span>state<span class="token operator">=</span><span class="token string">'California'</span><span class="token punctuation">)</span><span class="token operator">or</span><span class="token punctuation">(</span><span class="token punctuation">(</span>users_0<span class="token punctuation">.</span>state<span class="token operator">=</span><span class="token string">'New York'</span><span class="token punctuation">)</span><span class="token operator">or</span><span class="token punctuation">(</span>users_0<span class="token punctuation">.</span>state<span class="token operator">=</span><span class="token string">'Texas'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">AND</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>IFNULL<span class="token punctuation">(</span><span class="token operator">NOT</span><span class="token punctuation">(</span>order_items<span class="token punctuation">.</span><span class="token keyword">status</span><span class="token operator">=</span><span class="token string">'Cancelled'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">and</span><span class="token punctuation">(</span>IFNULL<span class="token punctuation">(</span><span class="token operator">NOT</span><span class="token punctuation">(</span>order_items<span class="token punctuation">.</span><span class="token keyword">status</span><span class="token operator">=</span><span class="token string">'Processing'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token number">1</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token number">2</span> <span class="token keyword">desc</span>
</pre>
      </div>
    </div>
  </div><p>Queries can contain other nested structures, by including additional transformations as fields, so our named query (<code class="language-malloy">sales_by_month_2020</code>) can also now be called anywhere as a nested structure. Note that these structures can nest infinitely!:</p>
<pre class="language-malloy"><span class="token keyword">query</span>: order_items <span class="token operator">-</span><span class="token operator">></span> {
  <span class="token keyword">group_by</span>: users<span class="token punctuation">.</span>state
  <span class="token keyword">aggregate</span>: total_sales
  <span class="token keyword">nest</span>: <span class="token punctuation">[</span>
    orders_by_status
    sales_by_month_2020
    <span class="token punctuation">]</span>
}</pre><div class="result-outer large">
    <div class="result-controls-bar">
      <span class="result-label">QUERY RESULTS</span>
      <div class="result-controls">
        <button class="result-control" selected data-result-kind="html">HTML</button>
        <button class="result-control"  data-result-kind="json">JSON</button>
        <button class="result-control"  data-result-kind="sql">SQL</button>
      </div>
    </div>
    <div class="result-middle" data-result-kind="html" selected>
      <div class="result-inner">
        <table style="border: 1px solid #eaeaea; vertical-align: top; border-bottom: 1px solid #eaeaea; border-collapse: collapse; width: 100%;">
		<thead>
			<tr>
				<th style="padding: 8px; color: #505050; border-bottom: 1px solid #eaeaea; text-align: left;">state</th>
<th style="padding: 8px; color: #505050; border-bottom: 1px solid #eaeaea; text-align: right;">total_&#8203;sales</th>
<th style="padding: 8px; color: #505050; border-bottom: 1px solid #eaeaea; text-align: left;">orders_&#8203;by_&#8203;status</th>
<th style="padding: 8px; color: #505050; border-bottom: 1px solid #eaeaea; text-align: left;">sales_&#8203;by_&#8203;month_&#8203;2020</th>
      </tr>
		</thead>
		<tbody>
			<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">California</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">1,539,771.836</td>
<td style="padding: 0; vertical-align: top; border-bottom: 1px solid #eaeaea; "><table style="border: 1px solid #eaeaea; vertical-align: top; border-bottom: 1px solid #eaeaea; border-collapse: collapse; width: 100%;">
		<thead>
			<tr>
				<th style="padding: 8px; color: #505050; border-bottom: 1px solid #eaeaea; text-align: left;">status</th>
<th style="padding: 8px; color: #505050; border-bottom: 1px solid #eaeaea; text-align: right;">order_&#8203;count</th>
      </tr>
		</thead>
		<tbody>
			<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Complete</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">30,698</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Cancelled</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">1,142</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Returned</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">323</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Shipped</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">241</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Processing</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">137</td>
</tr>

		</tbody>
	</table></td>
<td style="padding: 0; vertical-align: top; border-bottom: 1px solid #eaeaea; "><table style="border: 1px solid #eaeaea; vertical-align: top; border-bottom: 1px solid #eaeaea; border-collapse: collapse; width: 100%;">
		<thead>
			<tr>
				<th style="padding: 8px; color: #505050; border-bottom: 1px solid #eaeaea; text-align: left;">order_&#8203;month</th>
<th style="padding: 8px; color: #505050; border-bottom: 1px solid #eaeaea; text-align: right;">total_&#8203;sales</th>
      </tr>
		</thead>
		<tbody>
			<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-12</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">57,695.93</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-11</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">54,365.51</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-10</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">52,298.45</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-09</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">50,920.11</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-08</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">47,374.12</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-07</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">46,771.7</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-06</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">41,960.92</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-05</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">44,562.07</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-04</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">43,275.72</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-03</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">46,044.38</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-02</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">38,662.13</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-01</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">37,149.69</td>
</tr>

		</tbody>
	</table></td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Texas</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">920,402.463</td>
<td style="padding: 0; vertical-align: top; border-bottom: 1px solid #eaeaea; "><table style="border: 1px solid #eaeaea; vertical-align: top; border-bottom: 1px solid #eaeaea; border-collapse: collapse; width: 100%;">
		<thead>
			<tr>
				<th style="padding: 8px; color: #505050; border-bottom: 1px solid #eaeaea; text-align: left;">status</th>
<th style="padding: 8px; color: #505050; border-bottom: 1px solid #eaeaea; text-align: right;">order_&#8203;count</th>
      </tr>
		</thead>
		<tbody>
			<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Complete</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">18,398</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Cancelled</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">705</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Returned</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">208</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Shipped</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">100</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Processing</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">61</td>
</tr>

		</tbody>
	</table></td>
<td style="padding: 0; vertical-align: top; border-bottom: 1px solid #eaeaea; "><table style="border: 1px solid #eaeaea; vertical-align: top; border-bottom: 1px solid #eaeaea; border-collapse: collapse; width: 100%;">
		<thead>
			<tr>
				<th style="padding: 8px; color: #505050; border-bottom: 1px solid #eaeaea; text-align: left;">order_&#8203;month</th>
<th style="padding: 8px; color: #505050; border-bottom: 1px solid #eaeaea; text-align: right;">total_&#8203;sales</th>
      </tr>
		</thead>
		<tbody>
			<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-12</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">36,157.21</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-11</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">32,742.49</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-10</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">35,763.75</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-09</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">29,206.38</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-08</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">26,788.34</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-07</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">27,071.27</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-06</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">25,285.95</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-05</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">24,210.73</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-04</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">23,920.98</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-03</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">24,183.6</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-02</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">23,102.07</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-01</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">22,290.5</td>
</tr>

		</tbody>
	</table></td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">New York</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">628,942.412</td>
<td style="padding: 0; vertical-align: top; border-bottom: 1px solid #eaeaea; "><table style="border: 1px solid #eaeaea; vertical-align: top; border-bottom: 1px solid #eaeaea; border-collapse: collapse; width: 100%;">
		<thead>
			<tr>
				<th style="padding: 8px; color: #505050; border-bottom: 1px solid #eaeaea; text-align: left;">status</th>
<th style="padding: 8px; color: #505050; border-bottom: 1px solid #eaeaea; text-align: right;">order_&#8203;count</th>
      </tr>
		</thead>
		<tbody>
			<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Complete</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">12,583</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Cancelled</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">451</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Returned</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">134</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Shipped</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">68</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Processing</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">40</td>
</tr>

		</tbody>
	</table></td>
<td style="padding: 0; vertical-align: top; border-bottom: 1px solid #eaeaea; "><table style="border: 1px solid #eaeaea; vertical-align: top; border-bottom: 1px solid #eaeaea; border-collapse: collapse; width: 100%;">
		<thead>
			<tr>
				<th style="padding: 8px; color: #505050; border-bottom: 1px solid #eaeaea; text-align: left;">order_&#8203;month</th>
<th style="padding: 8px; color: #505050; border-bottom: 1px solid #eaeaea; text-align: right;">total_&#8203;sales</th>
      </tr>
		</thead>
		<tbody>
			<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-12</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">22,863.1</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-11</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">23,641.71</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-10</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">24,208.24</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-09</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">19,220.52</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-08</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">18,260.89</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-07</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">17,018.14</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-06</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">16,414.15</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-05</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">16,537.97</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-04</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">19,970.49</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-03</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">15,851.28</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-02</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">15,669.13</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-01</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">14,601.01</td>
</tr>

		</tbody>
	</table></td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Illinois</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">527,157.372</td>
<td style="padding: 0; vertical-align: top; border-bottom: 1px solid #eaeaea; "><table style="border: 1px solid #eaeaea; vertical-align: top; border-bottom: 1px solid #eaeaea; border-collapse: collapse; width: 100%;">
		<thead>
			<tr>
				<th style="padding: 8px; color: #505050; border-bottom: 1px solid #eaeaea; text-align: left;">status</th>
<th style="padding: 8px; color: #505050; border-bottom: 1px solid #eaeaea; text-align: right;">order_&#8203;count</th>
      </tr>
		</thead>
		<tbody>
			<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Complete</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">10,548</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Cancelled</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">405</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Returned</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">111</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Shipped</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">78</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Processing</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">30</td>
</tr>

		</tbody>
	</table></td>
<td style="padding: 0; vertical-align: top; border-bottom: 1px solid #eaeaea; "><table style="border: 1px solid #eaeaea; vertical-align: top; border-bottom: 1px solid #eaeaea; border-collapse: collapse; width: 100%;">
		<thead>
			<tr>
				<th style="padding: 8px; color: #505050; border-bottom: 1px solid #eaeaea; text-align: left;">order_&#8203;month</th>
<th style="padding: 8px; color: #505050; border-bottom: 1px solid #eaeaea; text-align: right;">total_&#8203;sales</th>
      </tr>
		</thead>
		<tbody>
			<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-12</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">20,242.45</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-11</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">19,276.62</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-10</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">15,826.88</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-09</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">16,070.6</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-08</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">14,747.61</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-07</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">16,104.34</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-06</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">14,405.61</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-05</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">14,105</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-04</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">15,246.36</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-03</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">13,413.23</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-02</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">13,309.83</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-01</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">12,825.07</td>
</tr>

		</tbody>
	</table></td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Florida</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">369,103.322</td>
<td style="padding: 0; vertical-align: top; border-bottom: 1px solid #eaeaea; "><table style="border: 1px solid #eaeaea; vertical-align: top; border-bottom: 1px solid #eaeaea; border-collapse: collapse; width: 100%;">
		<thead>
			<tr>
				<th style="padding: 8px; color: #505050; border-bottom: 1px solid #eaeaea; text-align: left;">status</th>
<th style="padding: 8px; color: #505050; border-bottom: 1px solid #eaeaea; text-align: right;">order_&#8203;count</th>
      </tr>
		</thead>
		<tbody>
			<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Complete</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">7,495</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Cancelled</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">256</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Returned</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">86</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Shipped</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">40</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">Processing</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">22</td>
</tr>

		</tbody>
	</table></td>
<td style="padding: 0; vertical-align: top; border-bottom: 1px solid #eaeaea; "><table style="border: 1px solid #eaeaea; vertical-align: top; border-bottom: 1px solid #eaeaea; border-collapse: collapse; width: 100%;">
		<thead>
			<tr>
				<th style="padding: 8px; color: #505050; border-bottom: 1px solid #eaeaea; text-align: left;">order_&#8203;month</th>
<th style="padding: 8px; color: #505050; border-bottom: 1px solid #eaeaea; text-align: right;">total_&#8203;sales</th>
      </tr>
		</thead>
		<tbody>
			<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-12</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">13,086.99</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-11</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">14,909.82</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-10</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">12,997.54</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-09</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">10,117.96</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-08</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">11,594.44</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-07</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">11,254.97</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-06</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">10,162.69</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-05</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">10,830.16</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-04</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">11,232</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-03</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">11,762.23</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-02</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">10,759.31</td>
</tr>
<tr><td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; ">2020-01</td>
<td style="padding: 8px; vertical-align: top; border-bottom: 1px solid #eaeaea; text-align: right;">9,161.25</td>
</tr>

		</tbody>
	</table></td>
</tr>

		</tbody>
	</table>
      </div>
    </div>
    <div class="result-middle" data-result-kind="json" >
      <div class="result-inner">
        <pre><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token property">"state"</span><span class="token operator">:</span> <span class="token string">"California"</span><span class="token punctuation">,</span>
    <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">1539771.8357886076</span><span class="token punctuation">,</span>
    <span class="token property">"orders_by_status"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">"status"</span><span class="token operator">:</span> <span class="token string">"Complete"</span><span class="token punctuation">,</span>
        <span class="token property">"order_count"</span><span class="token operator">:</span> <span class="token number">30698</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"status"</span><span class="token operator">:</span> <span class="token string">"Cancelled"</span><span class="token punctuation">,</span>
        <span class="token property">"order_count"</span><span class="token operator">:</span> <span class="token number">1142</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"status"</span><span class="token operator">:</span> <span class="token string">"Returned"</span><span class="token punctuation">,</span>
        <span class="token property">"order_count"</span><span class="token operator">:</span> <span class="token number">323</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"status"</span><span class="token operator">:</span> <span class="token string">"Shipped"</span><span class="token punctuation">,</span>
        <span class="token property">"order_count"</span><span class="token operator">:</span> <span class="token number">241</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"status"</span><span class="token operator">:</span> <span class="token string">"Processing"</span><span class="token punctuation">,</span>
        <span class="token property">"order_count"</span><span class="token operator">:</span> <span class="token number">137</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"sales_by_month_2020"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-12-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">57695.93021321297</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-11-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">54365.51019859314</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-10-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">52298.45022058487</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-09-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">50920.11014723778</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-08-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">47374.12017083168</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-07-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">46771.7001850605</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-06-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">41960.92015624046</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-05-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">44562.070222854614</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-04-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">43275.720215559006</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-03-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">46044.38015651703</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-02-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">38662.1302229166</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-01-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">37149.690194129944</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"state"</span><span class="token operator">:</span> <span class="token string">"Texas"</span><span class="token punctuation">,</span>
    <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">920402.4634789228</span><span class="token punctuation">,</span>
    <span class="token property">"orders_by_status"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">"status"</span><span class="token operator">:</span> <span class="token string">"Complete"</span><span class="token punctuation">,</span>
        <span class="token property">"order_count"</span><span class="token operator">:</span> <span class="token number">18398</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"status"</span><span class="token operator">:</span> <span class="token string">"Cancelled"</span><span class="token punctuation">,</span>
        <span class="token property">"order_count"</span><span class="token operator">:</span> <span class="token number">705</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"status"</span><span class="token operator">:</span> <span class="token string">"Returned"</span><span class="token punctuation">,</span>
        <span class="token property">"order_count"</span><span class="token operator">:</span> <span class="token number">208</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"status"</span><span class="token operator">:</span> <span class="token string">"Shipped"</span><span class="token punctuation">,</span>
        <span class="token property">"order_count"</span><span class="token operator">:</span> <span class="token number">100</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"status"</span><span class="token operator">:</span> <span class="token string">"Processing"</span><span class="token punctuation">,</span>
        <span class="token property">"order_count"</span><span class="token operator">:</span> <span class="token number">61</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"sales_by_month_2020"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-12-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">36157.21014499664</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-11-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">32742.490122556686</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-10-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">35763.75009179115</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-09-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">29206.38013267517</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-08-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">26788.340130090714</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-07-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">27071.270101308823</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-06-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">25285.950115680695</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-05-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">24210.730105400085</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-04-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">23920.980100870132</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-03-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">24183.600080013275</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-02-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">23102.07008457184</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-01-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">22290.500053167343</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"state"</span><span class="token operator">:</span> <span class="token string">"New York"</span><span class="token punctuation">,</span>
    <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">628942.4123652168</span><span class="token punctuation">,</span>
    <span class="token property">"orders_by_status"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">"status"</span><span class="token operator">:</span> <span class="token string">"Complete"</span><span class="token punctuation">,</span>
        <span class="token property">"order_count"</span><span class="token operator">:</span> <span class="token number">12583</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"status"</span><span class="token operator">:</span> <span class="token string">"Cancelled"</span><span class="token punctuation">,</span>
        <span class="token property">"order_count"</span><span class="token operator">:</span> <span class="token number">451</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"status"</span><span class="token operator">:</span> <span class="token string">"Returned"</span><span class="token punctuation">,</span>
        <span class="token property">"order_count"</span><span class="token operator">:</span> <span class="token number">134</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"status"</span><span class="token operator">:</span> <span class="token string">"Shipped"</span><span class="token punctuation">,</span>
        <span class="token property">"order_count"</span><span class="token operator">:</span> <span class="token number">68</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"status"</span><span class="token operator">:</span> <span class="token string">"Processing"</span><span class="token punctuation">,</span>
        <span class="token property">"order_count"</span><span class="token operator">:</span> <span class="token number">40</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"sales_by_month_2020"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-12-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">22863.100113391876</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-11-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">23641.71011163667</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-10-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">24208.24006664753</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-09-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">19220.52008509636</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-08-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">18260.89007139206</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-07-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">17018.140040159225</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-06-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">16414.150043964386</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-05-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">16537.970086097717</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-04-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">19970.49004650116</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-03-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">15851.280097007751</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-02-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">15669.130051732063</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-01-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">14601.010076761246</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"state"</span><span class="token operator">:</span> <span class="token string">"Illinois"</span><span class="token punctuation">,</span>
    <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">527157.3720983267</span><span class="token punctuation">,</span>
    <span class="token property">"orders_by_status"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">"status"</span><span class="token operator">:</span> <span class="token string">"Complete"</span><span class="token punctuation">,</span>
        <span class="token property">"order_count"</span><span class="token operator">:</span> <span class="token number">10548</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"status"</span><span class="token operator">:</span> <span class="token string">"Cancelled"</span><span class="token punctuation">,</span>
        <span class="token property">"order_count"</span><span class="token operator">:</span> <span class="token number">405</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"status"</span><span class="token operator">:</span> <span class="token string">"Returned"</span><span class="token punctuation">,</span>
        <span class="token property">"order_count"</span><span class="token operator">:</span> <span class="token number">111</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"status"</span><span class="token operator">:</span> <span class="token string">"Shipped"</span><span class="token punctuation">,</span>
        <span class="token property">"order_count"</span><span class="token operator">:</span> <span class="token number">78</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"status"</span><span class="token operator">:</span> <span class="token string">"Processing"</span><span class="token punctuation">,</span>
        <span class="token property">"order_count"</span><span class="token operator">:</span> <span class="token number">30</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"sales_by_month_2020"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-12-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">20242.450085878372</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-11-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">19276.62005352974</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-10-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">15826.88006734848</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-09-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">16070.600063800812</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-08-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">14747.610058784485</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-07-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">16104.340077638626</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-06-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">14405.610061049461</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-05-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">14105.000072360039</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-04-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">15246.360042333603</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-03-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">13413.230053663254</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-02-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">13309.830061674118</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-01-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">12825.070039272308</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"state"</span><span class="token operator">:</span> <span class="token string">"Florida"</span><span class="token punctuation">,</span>
    <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">369103.3215661049</span><span class="token punctuation">,</span>
    <span class="token property">"orders_by_status"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">"status"</span><span class="token operator">:</span> <span class="token string">"Complete"</span><span class="token punctuation">,</span>
        <span class="token property">"order_count"</span><span class="token operator">:</span> <span class="token number">7495</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"status"</span><span class="token operator">:</span> <span class="token string">"Cancelled"</span><span class="token punctuation">,</span>
        <span class="token property">"order_count"</span><span class="token operator">:</span> <span class="token number">256</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"status"</span><span class="token operator">:</span> <span class="token string">"Returned"</span><span class="token punctuation">,</span>
        <span class="token property">"order_count"</span><span class="token operator">:</span> <span class="token number">86</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"status"</span><span class="token operator">:</span> <span class="token string">"Shipped"</span><span class="token punctuation">,</span>
        <span class="token property">"order_count"</span><span class="token operator">:</span> <span class="token number">40</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"status"</span><span class="token operator">:</span> <span class="token string">"Processing"</span><span class="token punctuation">,</span>
        <span class="token property">"order_count"</span><span class="token operator">:</span> <span class="token number">22</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"sales_by_month_2020"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-12-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">13086.990067481995</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-11-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">14909.820038557053</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-10-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">12997.540064811707</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-09-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">10117.960050582886</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-08-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">11594.440055847168</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-07-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">11254.970042228699</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-06-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">10162.69005203247</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-05-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">10830.160037517548</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-04-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">11232.000043392181</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-03-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">11762.230028390884</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-02-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">10759.310051441193</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"order_month"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2020-01-01"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"total_sales"</span><span class="token operator">:</span> <span class="token number">9161.250037193298</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span></pre>
      </div>
    </div>
    <div class="result-middle" data-result-kind="sql" >
      <div class="result-inner">
        <pre><span class="token keyword">WITH</span> __stage0 <span class="token keyword">AS</span> <span class="token punctuation">(</span>
  <span class="token keyword">SELECT</span>
    group_set<span class="token punctuation">,</span>
    users_0<span class="token punctuation">.</span>state <span class="token keyword">as</span> state__0<span class="token punctuation">,</span>
    <span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> group_set<span class="token operator">=</span><span class="token number">0</span> <span class="token keyword">THEN</span> <span class="token function">SUM</span><span class="token punctuation">(</span>order_items<span class="token punctuation">.</span>sale_price<span class="token punctuation">)</span> <span class="token keyword">END</span> <span class="token keyword">as</span> total_sales__0<span class="token punctuation">,</span>
    <span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> group_set<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> order_items<span class="token punctuation">.</span><span class="token keyword">status</span> <span class="token keyword">END</span> <span class="token keyword">as</span> status__1<span class="token punctuation">,</span>
    <span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> group_set<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> order_items<span class="token punctuation">.</span>order_id<span class="token punctuation">)</span> <span class="token keyword">END</span> <span class="token keyword">as</span> order_count__1<span class="token punctuation">,</span>
    <span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> group_set<span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">THEN</span> DATE_TRUNC<span class="token punctuation">(</span><span class="token keyword">DATE</span><span class="token punctuation">(</span>TIMESTAMP_TRUNC<span class="token punctuation">(</span>order_items<span class="token punctuation">.</span>created_at<span class="token punctuation">,</span><span class="token keyword">MONTH</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'UTC'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">month</span><span class="token punctuation">)</span> <span class="token keyword">END</span> <span class="token keyword">as</span> order_month__2<span class="token punctuation">,</span>
    <span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> group_set<span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">THEN</span> <span class="token function">SUM</span><span class="token punctuation">(</span>order_items<span class="token punctuation">.</span>sale_price<span class="token punctuation">)</span> <span class="token keyword">END</span> <span class="token keyword">as</span> total_sales__2
  <span class="token keyword">FROM</span> <span class="token punctuation">`</span>malloy<span class="token operator">-</span><span class="token keyword">data</span><span class="token punctuation">.</span>ecomm<span class="token punctuation">.</span>order_items<span class="token punctuation">`</span> <span class="token keyword">as</span> order_items
  <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> <span class="token punctuation">`</span>malloy<span class="token operator">-</span><span class="token keyword">data</span><span class="token punctuation">.</span>ecomm<span class="token punctuation">.</span>users<span class="token punctuation">`</span> <span class="token keyword">AS</span> users_0 <span class="token keyword">ON</span> order_items<span class="token punctuation">.</span>user_id <span class="token operator">=</span> users_0<span class="token punctuation">.</span>id
  <span class="token keyword">CROSS</span> <span class="token keyword">JOIN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> row_number<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token number">1</span>  group_set <span class="token keyword">FROM</span> UNNEST<span class="token punctuation">(</span>GENERATE_ARRAY<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">WHERE</span> <span class="token punctuation">(</span>group_set <span class="token operator">NOT</span> <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token punctuation">(</span>group_set <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">AND</span> <span class="token punctuation">(</span>order_items<span class="token punctuation">.</span>created_at<span class="token operator">>=</span><span class="token string">'2020-01-01'</span><span class="token punctuation">)</span><span class="token operator">and</span><span class="token punctuation">(</span>order_items<span class="token punctuation">.</span>created_at<span class="token operator">&lt;</span><span class="token string">'2021-01-01'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">6</span>
<span class="token punctuation">)</span>
<span class="token keyword">SELECT</span>
  state__0 <span class="token keyword">as</span> state<span class="token punctuation">,</span>
  ANY_VALUE<span class="token punctuation">(</span><span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> group_set<span class="token operator">=</span><span class="token number">0</span> <span class="token keyword">THEN</span> total_sales__0 <span class="token keyword">END</span><span class="token punctuation">)</span> <span class="token keyword">as</span> total_sales<span class="token punctuation">,</span>
  ARRAY_AGG<span class="token punctuation">(</span><span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> group_set<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> STRUCT<span class="token punctuation">(</span>status__1 <span class="token keyword">as</span> <span class="token keyword">status</span><span class="token punctuation">,</span> order_count__1 <span class="token keyword">as</span> order_count<span class="token punctuation">)</span> <span class="token keyword">END</span> <span class="token keyword">IGNORE</span> NULLS  <span class="token keyword">ORDER</span> <span class="token keyword">BY</span>  order_count__1 <span class="token keyword">desc</span> <span class="token punctuation">)</span> <span class="token keyword">as</span> orders_by_status<span class="token punctuation">,</span>
  ARRAY_AGG<span class="token punctuation">(</span><span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> group_set<span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">THEN</span> STRUCT<span class="token punctuation">(</span>order_month__2 <span class="token keyword">as</span> order_month<span class="token punctuation">,</span> total_sales__2 <span class="token keyword">as</span> total_sales<span class="token punctuation">)</span> <span class="token keyword">END</span> <span class="token keyword">IGNORE</span> NULLS  <span class="token keyword">ORDER</span> <span class="token keyword">BY</span>  order_month__2 <span class="token keyword">desc</span> <span class="token punctuation">)</span> <span class="token keyword">as</span> sales_by_month_2020
<span class="token keyword">FROM</span> __stage0
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token number">1</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token number">2</span> <span class="token keyword">desc</span>
</pre>
      </div>
    </div>
  </div><p>Which can be visualized using a data_style</p>
<pre class="language-">{"sales_by_month_2020" : {
   "renderer" : "line_chart"}
, "orders_by_status" : {
   "renderer" : "bar_chart"}
}</pre><img width="899" alt="Screen Shot 2021-08-18 at 4 44 01 PM" src="https://user-images.githubusercontent.com/7178946/130128542-e122eab9-5cf2-48cb-b87c-ce520517d595.png"><p>Putting a few named queries together as nested structures allows us to produce a dashboard with an overview of sales, having written remarkably little code. Use the <code class="language-malloy">dashboard</code> renderer to format the results like this:</p>
<pre class="language-malloy">state_dashboard <span class="token keyword">is</span> <span class="token punctuation">(</span><span class="token keyword">reduce</span>
 users<span class="token punctuation">.</span>state
 total_sales
 order_count
 orders_by_status
 sales_by_month_2020
<span class="token punctuation">)</span></pre><img width="865" alt="Screen Shot 2021-08-19 at 12 01 56 PM" src="https://user-images.githubusercontent.com/7178946/130128823-6b7f8e97-ec28-4ced-9e38-c72384eb976b.png"></div>