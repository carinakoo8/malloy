<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Malloy Documentation</title>
    <link rel="stylesheet" href="/malloy/css/document.css" />
    <link rel="shortcut icon" type="image/x-icon" href="/img/favicon.ico" />
    <script
  async
  src="https://www.googletagmanager.com/gtag/js?id=G-0M10W7C20Y"
></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() {
    dataLayer.push(arguments);
  }
  gtag("js", new Date());

  gtag("config", "G-0M10W7C20Y");
</script>

  </head>
  <body>
    <div class="top">
      <div class="header">
        <div class="header-banner">
          <img src="/malloy/img/logo.png" alt="malloy logo" />
          Malloy
          <span class="subtitle">Documentation</span>
        </div>
        <form onSubmit="() => alert('submit')" action="/malloy/search">
          <div class="search-input-outer">
            <img src="/malloy/img/search.svg" alt="search" />
            <input placeholder="Search" id="search-input" name="query" />
          </div>
          <input type="submit" style="display: none" />
        </form>
      </div>
      <div class="main">
        <div class="sidebar" id="sidebar">
    <div class="sidebar-section">
      <div id=getting_started
        class="sidebar-section-title collapsed"
      >
        Getting Started
        <img class="chevron-open" src="/malloy/img/section_open.svg" alt="section open"/>
        <img class="chevron-closed" src="/malloy/img/section_close.svg" alt="section closed"/>
      </div>
      <div class="sidebar-section-item-group">
        <div class='sidebar-item '>
      <a href="/malloy/documentation/index.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        About Malloy
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/malloy_by_example.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Malloy By Example
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/language/basic.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Quickstart
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/features.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Key Features
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/samples.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Sample Models
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/connection_instructions.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Connecting a Database
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/tao.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        The Tao of Malloy
      </a>
    </div>
      </div>
    </div>
<div class="sidebar-section">
      <div id=language_reference
        class="sidebar-section-title collapsed"
      >
        Language Reference
        <img class="chevron-open" src="/malloy/img/section_open.svg" alt="section open"/>
        <img class="chevron-closed" src="/malloy/img/section_close.svg" alt="section closed"/>
      </div>
      <div class="sidebar-section-item-group">
        <div class='sidebar-item '>
      <a href="/malloy/documentation/language/overview.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Introduction
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/language/sql_to_malloy.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        SQL to Malloy
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/language/statement.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Models
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/language/source.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Sources
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/language/query.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Queries
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/language/fields.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Fields
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/language/aggregates.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Aggregates
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/language/filters.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Filters
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/language/order_by.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Ordering and Limiting
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/language/join.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Joins
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/language/nesting.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Nested Queries
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/language/expressions.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Expressions
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/language/sql_blocks.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        SQL Blocks
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/language/imports.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Imports
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/language/types.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Types
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/language/changelog.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Change Log
      </a>
    </div>
      </div>
    </div>
<div class="sidebar-section">
      <div id=rendering_results
        class="sidebar-section-title collapsed"
      >
        Rendering Results
        <img class="chevron-open" src="/malloy/img/section_open.svg" alt="section open"/>
        <img class="chevron-closed" src="/malloy/img/section_close.svg" alt="section closed"/>
      </div>
      <div class="sidebar-section-item-group">
        <div class='sidebar-item '>
      <a href="/malloy/documentation/visualizations/dashboards.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Intro: Charts & Dashboards
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/visualizations/bar_charts.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Bar Charts
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/visualizations/charts_line_chart.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Line Charts
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/visualizations/scatter_charts.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Scatter Charts
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/visualizations/shape_maps.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Shape Maps
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/visualizations/segment_maps.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Segment Maps
      </a>
    </div>
      </div>
    </div>
<div class="sidebar-section">
      <div id=common_patterns
        class="sidebar-section-title collapsed"
      >
        Common Patterns
        <img class="chevron-open" src="/malloy/img/section_open.svg" alt="section open"/>
        <img class="chevron-closed" src="/malloy/img/section_close.svg" alt="section closed"/>
      </div>
      <div class="sidebar-section-item-group">
        <div class='sidebar-item '>
      <a href="/malloy/documentation/patterns/yoy.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Year Over Year Analysis
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/patterns/foreign_sums.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Foreign Sums and Averages
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/patterns/percent_of_total.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Percent of Total
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/patterns/cohorts.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Cohort Analysis
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/patterns/pivot_limits.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Pivot Limits
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/patterns/sessionize.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Sessionized Data
      </a>
    </div>
      </div>
    </div>
<div class="sidebar-section">
      <div id=examples
        class="sidebar-section-title collapsed"
      >
        Examples
        <img class="chevron-open" src="/malloy/img/section_open.svg" alt="section open"/>
        <img class="chevron-closed" src="/malloy/img/section_close.svg" alt="section closed"/>
      </div>
      <div class="sidebar-section-item-group">
        <div class="sidebar-section">
      <div id=ntsb_flight database
        class="sidebar-section-title collapsed"
      >
        NTSB Flight Database
        <img class="chevron-open" src="/malloy/img/section_open.svg" alt="section open"/>
        <img class="chevron-closed" src="/malloy/img/section_close.svg" alt="section closed"/>
      </div>
      <div class="sidebar-section-item-group">
        <div class='sidebar-item '>
      <a href="/malloy/documentation/examples/faa/bigquery.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        FAA Dashboards
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/examples/faa/postgres.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Connect with Postgres
      </a>
    </div>
      </div>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/examples/ecommerce.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        eCommerce Analysis
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/examples/names.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        The Name Game
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/examples/ga_sessions.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Google Analytics GA360
      </a>
    </div>
      </div>
    </div>
<div class="sidebar-section">
      <div id=walkthrough:_iowa liquor
        class="sidebar-section-title collapsed"
      >
        Walkthrough: Iowa Liquor
        <img class="chevron-open" src="/malloy/img/section_open.svg" alt="section open"/>
        <img class="chevron-closed" src="/malloy/img/section_close.svg" alt="section closed"/>
      </div>
      <div class="sidebar-section-item-group">
        <div class='sidebar-item '>
      <a href="/malloy/documentation/examples/iowa/iowa.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        About the Data Set
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/examples/iowa/source.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        The Malloy Data Model
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/examples/iowa/step2.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Basic Calculations
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/examples/iowa/step2a.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Analysis: Products and Brands
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/examples/iowa/step3.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Bucketing and Mapping
      </a>
    </div>
<div class='sidebar-item active'>
      <a href="/malloy/documentation/examples/iowa/step6.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Dashboards
      </a>
    </div>
      </div>
    </div>
<div class="sidebar-section">
      <div id=walkthrough:_wordle solver
        class="sidebar-section-title collapsed"
      >
        Walkthrough: Wordle Solver
        <img class="chevron-open" src="/malloy/img/section_open.svg" alt="section open"/>
        <img class="chevron-closed" src="/malloy/img/section_close.svg" alt="section closed"/>
      </div>
      <div class="sidebar-section-item-group">
        <div class='sidebar-item '>
      <a href="/malloy/documentation/examples/wordle/wordle.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Just Words
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/examples/wordle/wordle1a.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Letters and Positioning
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/examples/wordle/wordle2.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Letter Frequency
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/examples/wordle/wordle3.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Scoring Words
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/examples/wordle/wordle4.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Final Model
      </a>
    </div>
<div class='sidebar-item '>
      <a href="/malloy/documentation/examples/wordle/wordle5.html">
        <img src="/malloy/img/article_icon.svg" alt="document"/>
        Solving Puzzles
      </a>
    </div>
      </div>
    </div>
  </div>
        <script src="/malloy/js/sidebar_state.js"></script>
        <div class="content">
          <div class="footer">
             <div class="linear-navigation">
    <div class="item">
      <a href="step3.html"><img src="/malloy/img/previous.svg" alt="previous"/>Bucketing and Mapping</a>
    </div>
    <div class="item">
      <a href="../wordle/wordle.html">Just Words<img src="/malloy/img/next.svg" alt="next"/></a>
    </div>
  </div> 
          </div>
          <div class="document-outer"><div class="document">
      <h1>
        <a id="dashboards" class="header-link anchor" href="#dashboards">
          Dashboards
        </a>
      </h1>
    <p>Putting it all together we can write a dashboard</p>
<pre class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #AF00DB">query</span><span style="color: #000000">: </span><span style="color: #001080">vendor_dashboard</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">group_by</span><span style="color: #000000">: </span><span style="color: #001080">vendor_count</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">count</span><span style="color: #000000">(</span><span style="color: #795E26">distinct</span><span style="color: #000000"> </span><span style="color: #001080">vendor_number</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">aggregate</span><span style="color: #000000">:</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">total_sale_dollars</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">total_bottles</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">nest</span><span style="color: #000000">:</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">by_month</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">by_class</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">by_vendor_bar_chart</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">top_sellers_by_revenue</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">most_expensive_products</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">by_vendor_dashboard</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #AF00DB">top</span><span style="color: #000000">: </span><span style="color: #098658">10</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #AF00DB">group_by</span><span style="color: #000000">: </span><span style="color: #001080">vendor_name</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #AF00DB">aggregate</span><span style="color: #000000">: </span><span style="color: #001080">total_sale_dollars</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #AF00DB">nest</span><span style="color: #000000">: </span><span style="color: #001080">by_month</span><span style="color: #000000">, </span><span style="color: #001080">top_sellers_by_revenue</span><span style="color: #000000">, </span><span style="color: #001080">most_expensive_products</span></span>
<span class="line"><span style="color: #000000">    }</span></span>
<span class="line"><span style="color: #000000">}</span></span></pre>
      <h2>
        <a id="run-dashboard" class="header-link anchor" href="#run-dashboard">
          Run Dashboard
        </a>
      </h2>
    <p>Simply add some filters.  Notice the sub-dashboard for each of the Vendors.</p>
<pre class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #AF00DB">query</span><span style="color: #000000">: </span><span style="color: #001080">iowa</span><span style="color: #000000"> { </span><span style="color: #AF00DB">where</span><span style="color: #000000">: </span><span style="color: #001080">category_class</span><span style="color: #000000"> = </span><span style="color: #A31515">&#39;VODKAS&#39;</span><span style="color: #000000"> } -&gt; </span><span style="color: #001080">vendor_dashboard</span></span></pre><div class="result-outer large">
    <div class="result-controls-bar">
      <span class="result-label">QUERY RESULTS</span>
      <div class="result-controls">
        <button class="result-control" selected data-result-kind="html">HTML</button>
        <button class="result-control"  data-result-kind="json">JSON</button>
        <button class="result-control"  data-result-kind="sql">SQL</button>
      </div>
    </div>
    <div class="result-middle" data-result-kind="html" selected>
      <div class="result-inner">
        <div><div style="position: relative;"><div class="dimensions" style="display: flex; flex-wrap: wrap;"></div><div class="dashboard-outer" style="display: flex; flex-direction: row; font-size: 11px;"><div style="display: flex; flex-wrap: wrap;"><div style="margin: 6px; border-radius: 5px; padding: 10px; flex: 1 0 auto; box-shadow: 0 1px 5px 0 var(--malloy-tile-background-color, #f3f3f3); max-width: calc(100% - 11px); display: flex; flex-direction: column; overflow: hidden;"><div style="font-size: 11px; font-family: var(--malloy-font-family, &quot;Roboto&quot;); font-weight: 500;">vendor_count</div><div style="display: flex; flex-direction: column; justify-content: center; flex: 1 0 auto;"><div style="font-size: 20px; display: flex; justify-content: center; align-items: center; margin-top: 5px;"><span>275</span></div></div></div><div style="margin: 6px; border-radius: 5px; padding: 10px; flex: 1 0 auto; box-shadow: 0 1px 5px 0 var(--malloy-tile-background-color, #f3f3f3); max-width: calc(100% - 11px); display: flex; flex-direction: column; overflow: hidden;"><div style="font-size: 11px; font-family: var(--malloy-font-family, &quot;Roboto&quot;); font-weight: 500;">total_sale_dollars</div><div style="display: flex; flex-direction: column; justify-content: center; flex: 1 0 auto;"><div style="font-size: 20px; display: flex; justify-content: center; align-items: center; margin-top: 5px;"><span>794,224,481.36</span></div></div></div><div style="margin: 6px; border-radius: 5px; padding: 10px; flex: 1 0 auto; box-shadow: 0 1px 5px 0 var(--malloy-tile-background-color, #f3f3f3); max-width: calc(100% - 11px); display: flex; flex-direction: column; overflow: hidden;"><div style="font-size: 11px; font-family: var(--malloy-font-family, &quot;Roboto&quot;); font-weight: 500;">total_bottles</div><div style="display: flex; flex-direction: column; justify-content: center; flex: 1 0 auto;"><div style="font-size: 20px; display: flex; justify-content: center; align-items: center; margin-top: 5px;"><span>73,968,002</span></div></div></div><div style="margin: 6px; border-radius: 5px; padding: 10px; flex: 1 0 auto; box-shadow: 0 1px 5px 0 var(--malloy-tile-background-color, #f3f3f3); max-width: calc(100% - 11px); display: flex; flex-direction: column; overflow: hidden;"><div style="font-size: 11px; font-family: var(--malloy-font-family, &quot;Roboto&quot;); font-weight: 500;">top_sellers_by_revenue</div><div style="display: flex; flex-direction: column; justify-content: center; flex: 1 0 auto;"><div style="display: flex; justify-content: center; align-items: center; flex-direction: column;"><table style="vertical-align: top; border-collapse: collapse; width: 100%;"><thead><tr><th style="padding: 8px; text-align: left;">vendor_​name</th><th style="padding: 8px; text-align: left;">item_​description</th><th style="padding: 8px; text-align: right;">total_​sale_​dollars</th><th style="padding: 8px; text-align: right;">total_​bottles</th><th style="padding: 8px; text-align: right;">avg_​price_​per_​100ml</th><th style="padding: 8px; text-align: right;">percent_​of_​sales</th></tr></thead><tbody><tr><td style="padding: 8px; vertical-align: top;"><span>FIFTH GENERATION INC</span></td><td style="padding: 8px; vertical-align: top;"><span>Titos Handmade Vodka</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>114,917,664.13</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>6,027,811</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>1.903</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>14.469</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>Luxco-St Louis</span></td><td style="padding: 8px; vertical-align: top;"><span>Hawkeye Vodka</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>45,992,518.19</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>6,707,537</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>0.655</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>5.791</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>Pernod Ricard USA/Austin Nichols</span></td><td style="padding: 8px; vertical-align: top;"><span>Absolut Swedish Vodka 80 Prf</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>30,837,591.61</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>1,545,367</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>2.204</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>3.883</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>Bacardi U.S.A., Inc.</span></td><td style="padding: 8px; vertical-align: top;"><span>Grey Goose Vodka</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>26,410,156.5</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>1,145,209</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>3.519</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>3.325</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>DIAGEO AMERICAS</span></td><td style="padding: 8px; vertical-align: top;"><span>Smirnoff 80prf</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>19,877,579.13</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>1,885,000</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>1.668</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>2.503</span></td></tr></tbody></table></div></div></div></div></div></div></div>
      </div>
    </div>
    <div class="result-middle" data-result-kind="json" >
      <div class="result-inner">
        <pre><pre class="language-json" style="background-color: #FBFBFB"><span class="line"><span style="color: #000000">[</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;vendor_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">275</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;total_sale_dollars&quot;</span><span style="color: #000000">: </span><span style="color: #098658">794224481.3601199</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;total_bottles&quot;</span><span style="color: #000000">: </span><span style="color: #098658">73968002</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;top_sellers_by_revenue&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;vendor_name&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;FIFTH GENERATION INC&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;item_description&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Titos Handmade Vodka&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;total_sale_dollars&quot;</span><span style="color: #000000">: </span><span style="color: #098658">114917664.13000374</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;total_bottles&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6027811</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;avg_price_per_100ml&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1.9030784205302218</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;percent_of_sales&quot;</span><span style="color: #000000">: </span><span style="color: #098658">14.469166693679062</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;vendor_name&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Luxco-St Louis&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;item_description&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Hawkeye Vodka&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;total_sale_dollars&quot;</span><span style="color: #000000">: </span><span style="color: #098658">45992518.19000298</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;total_bottles&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6707537</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;avg_price_per_100ml&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0.6554606565265768</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;percent_of_sales&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5.790871380751218</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;vendor_name&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Pernod Ricard USA/Austin Nichols&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;item_description&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Absolut Swedish Vodka 80 Prf&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;total_sale_dollars&quot;</span><span style="color: #000000">: </span><span style="color: #098658">30837591.609999333</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;total_bottles&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1545367</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;avg_price_per_100ml&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2.2043805281220057</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;percent_of_sales&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3.8827299250697425</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;vendor_name&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Bacardi U.S.A., Inc.&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;item_description&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Grey Goose Vodka&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;total_sale_dollars&quot;</span><span style="color: #000000">: </span><span style="color: #098658">26410156.499999974</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;total_bottles&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1145209</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;avg_price_per_100ml&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3.5186447295186616</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;percent_of_sales&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3.325276054796527</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;vendor_name&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;DIAGEO AMERICAS&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;item_description&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Smirnoff 80prf&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;total_sale_dollars&quot;</span><span style="color: #000000">: </span><span style="color: #098658">19877579.13000032</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;total_bottles&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1885000</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;avg_price_per_100ml&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1.6682797381895054</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;percent_of_sales&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2.5027658548071576</span></span>
<span class="line"><span style="color: #000000">      }</span></span>
<span class="line"><span style="color: #000000">    ]</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">]</span></span></pre></pre>
      </div>
    </div>
    <div class="result-middle" data-result-kind="sql" >
      <div class="result-inner">
        <pre><pre class="language-sql" style="background-color: #FBFBFB"><span class="line"><span style="color: #0000FF">WITH</span><span style="color: #000000"> __stage0 </span><span style="color: #0000FF">AS</span><span style="color: #000000"> (</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">SELECT</span></span>
<span class="line"><span style="color: #000000">    group_set,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">0</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #795E26">count</span><span style="color: #000000">(</span><span style="color: #0000FF">distinct</span><span style="color: #000000"> iowa.vendor_number)</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> vendor_count__0,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">0</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #795E26">COALESCE</span><span style="color: #000000">(</span><span style="color: #795E26">SUM</span><span style="color: #000000">(iowa.sale_dollars),</span><span style="color: #098658">0</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> total_sale_dollars__0,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">0</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #795E26">COALESCE</span><span style="color: #000000">(</span><span style="color: #795E26">SUM</span><span style="color: #000000">(iowa.bottles_sold),</span><span style="color: #098658">0</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> total_bottles__0,</span></span>
<span class="line"><span style="color: #000000">    __lateral_join_bag.vendor_name__1,</span></span>
<span class="line"><span style="color: #000000">    __lateral_join_bag.item_description__1,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #795E26">COALESCE</span><span style="color: #000000">(</span><span style="color: #795E26">SUM</span><span style="color: #000000">(iowa.sale_dollars),</span><span style="color: #098658">0</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> total_sale_dollars__1,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #795E26">COALESCE</span><span style="color: #000000">(</span><span style="color: #795E26">SUM</span><span style="color: #000000">(iowa.bottles_sold),</span><span style="color: #098658">0</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> total_bottles__1,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #795E26">AVG</span><span style="color: #000000">((iowa.state_bottle_retail/</span><span style="color: #795E26">nullif</span><span style="color: #000000">(iowa.bottle_volume_ml,</span><span style="color: #098658">0</span><span style="color: #000000">)*</span><span style="color: #098658">100</span><span style="color: #000000">))</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> avg_price_per_100ml__1,</span></span>
<span class="line"><span style="color: #000000">    (</span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #795E26">COALESCE</span><span style="color: #000000">(</span><span style="color: #795E26">SUM</span><span style="color: #000000">(iowa.sale_dollars),</span><span style="color: #098658">0</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000">)/</span><span style="color: #795E26">MAX</span><span style="color: #000000">((</span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">0</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #795E26">COALESCE</span><span style="color: #000000">(</span><span style="color: #795E26">SUM</span><span style="color: #000000">(iowa.sale_dollars),</span><span style="color: #098658">0</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000">)) </span><span style="color: #0000FF">OVER</span><span style="color: #000000"> ()*</span><span style="color: #098658">100</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> percent_of_sales__1</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">FROM</span><span style="color: #000000"> </span><span style="color: #A31515">`malloy-data.iowa_liquor_sales.sales_deduped`</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> iowa</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">CROSS</span><span style="color: #000000"> </span><span style="color: #0000FF">JOIN</span><span style="color: #000000"> (</span><span style="color: #0000FF">SELECT</span><span style="color: #000000"> </span><span style="color: #795E26">row_number</span><span style="color: #000000">() </span><span style="color: #0000FF">OVER</span><span style="color: #000000">() -</span><span style="color: #098658">1</span><span style="color: #000000">  group_set </span><span style="color: #0000FF">FROM</span><span style="color: #000000"> UNNEST(GENERATE_ARRAY(</span><span style="color: #098658">0</span><span style="color: #000000">,</span><span style="color: #098658">1</span><span style="color: #000000">,</span><span style="color: #098658">1</span><span style="color: #000000">)))</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">LEFT JOIN</span><span style="color: #000000"> UNNEST([STRUCT(</span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">    iowa.vendor_name</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">END</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> vendor_name__1,</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">    iowa.item_description</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">END</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> item_description__1)]) </span><span style="color: #0000FF">as</span><span style="color: #000000"> __lateral_join_bag</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">WHERE</span><span style="color: #000000"> ((</span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> REGEXP_CONTAINS(iowa.category_name, r</span><span style="color: #A31515">&#39;(WHISK|SCOTCH|BOURBON|RYE)&#39;</span><span style="color: #000000">) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;WHISKIES&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> REGEXP_CONTAINS(iowa.category_name, r</span><span style="color: #A31515">&#39;VODKA&#39;</span><span style="color: #000000">) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;VODKAS&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> REGEXP_CONTAINS(iowa.category_name, r</span><span style="color: #A31515">&#39;RUM&#39;</span><span style="color: #000000">) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;RUMS&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> REGEXP_CONTAINS(iowa.category_name, r</span><span style="color: #A31515">&#39;TEQUILA&#39;</span><span style="color: #000000">) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;TEQUILAS&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> REGEXP_CONTAINS(iowa.category_name, r</span><span style="color: #A31515">&#39;(LIQUE|AMARETTO|TRIPLE SEC)&#39;</span><span style="color: #000000">) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;LIQUEURS&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> REGEXP_CONTAINS(iowa.category_name, r</span><span style="color: #A31515">&#39;BRAND(I|Y)&#39;</span><span style="color: #000000">) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;BRANDIES&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> REGEXP_CONTAINS(iowa.category_name, r</span><span style="color: #A31515">&#39;GIN&#39;</span><span style="color: #000000">) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;GINS&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> REGEXP_CONTAINS(iowa.category_name, r</span><span style="color: #A31515">&#39;SCHNAP&#39;</span><span style="color: #000000">) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;SCHNAPPS&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">ELSE</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;OTHER&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">END</span><span style="color: #000000">)=</span><span style="color: #A31515">&#39;VODKAS&#39;</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">AND</span><span style="color: #000000"> ((</span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> REGEXP_CONTAINS(iowa.category_name, r</span><span style="color: #A31515">&#39;(WHISK|SCOTCH|BOURBON|RYE)&#39;</span><span style="color: #000000">) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;WHISKIES&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> REGEXP_CONTAINS(iowa.category_name, r</span><span style="color: #A31515">&#39;VODKA&#39;</span><span style="color: #000000">) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;VODKAS&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> REGEXP_CONTAINS(iowa.category_name, r</span><span style="color: #A31515">&#39;RUM&#39;</span><span style="color: #000000">) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;RUMS&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> REGEXP_CONTAINS(iowa.category_name, r</span><span style="color: #A31515">&#39;TEQUILA&#39;</span><span style="color: #000000">) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;TEQUILAS&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> REGEXP_CONTAINS(iowa.category_name, r</span><span style="color: #A31515">&#39;(LIQUE|AMARETTO|TRIPLE SEC)&#39;</span><span style="color: #000000">) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;LIQUEURS&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> REGEXP_CONTAINS(iowa.category_name, r</span><span style="color: #A31515">&#39;BRAND(I|Y)&#39;</span><span style="color: #000000">) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;BRANDIES&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> REGEXP_CONTAINS(iowa.category_name, r</span><span style="color: #A31515">&#39;GIN&#39;</span><span style="color: #000000">) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;GINS&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> REGEXP_CONTAINS(iowa.category_name, r</span><span style="color: #A31515">&#39;SCHNAP&#39;</span><span style="color: #000000">) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;SCHNAPPS&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">ELSE</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;OTHER&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">END</span><span style="color: #000000">)=</span><span style="color: #A31515">&#39;VODKAS&#39;</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">AND</span><span style="color: #000000"> ((group_set </span><span style="color: #0000FF">NOT</span><span style="color: #000000"> </span><span style="color: #0000FF">IN</span><span style="color: #000000"> (</span><span style="color: #098658">1</span><span style="color: #000000">) </span><span style="color: #0000FF">OR</span><span style="color: #000000"> (group_set </span><span style="color: #0000FF">IN</span><span style="color: #000000"> (</span><span style="color: #098658">1</span><span style="color: #000000">) </span><span style="color: #0000FF">AND</span><span style="color: #000000"> (</span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> REGEXP_CONTAINS(iowa.category_name, r</span><span style="color: #A31515">&#39;(WHISK|SCOTCH|BOURBON|RYE)&#39;</span><span style="color: #000000">) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;WHISKIES&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> REGEXP_CONTAINS(iowa.category_name, r</span><span style="color: #A31515">&#39;VODKA&#39;</span><span style="color: #000000">) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;VODKAS&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> REGEXP_CONTAINS(iowa.category_name, r</span><span style="color: #A31515">&#39;RUM&#39;</span><span style="color: #000000">) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;RUMS&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> REGEXP_CONTAINS(iowa.category_name, r</span><span style="color: #A31515">&#39;TEQUILA&#39;</span><span style="color: #000000">) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;TEQUILAS&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> REGEXP_CONTAINS(iowa.category_name, r</span><span style="color: #A31515">&#39;(LIQUE|AMARETTO|TRIPLE SEC)&#39;</span><span style="color: #000000">) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;LIQUEURS&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> REGEXP_CONTAINS(iowa.category_name, r</span><span style="color: #A31515">&#39;BRAND(I|Y)&#39;</span><span style="color: #000000">) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;BRANDIES&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> REGEXP_CONTAINS(iowa.category_name, r</span><span style="color: #A31515">&#39;GIN&#39;</span><span style="color: #000000">) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;GINS&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> REGEXP_CONTAINS(iowa.category_name, r</span><span style="color: #A31515">&#39;SCHNAP&#39;</span><span style="color: #000000">) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;SCHNAPPS&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">ELSE</span><span style="color: #000000"> </span><span style="color: #A31515">&#39;OTHER&#39;</span><span style="color: #000000"> </span><span style="color: #0000FF">END</span><span style="color: #000000">)=</span><span style="color: #A31515">&#39;VODKAS&#39;</span><span style="color: #000000">)))</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">GROUP BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000">,</span><span style="color: #098658">5</span><span style="color: #000000">,</span><span style="color: #098658">6</span></span>
<span class="line"><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #0000FF">SELECT</span></span>
<span class="line"><span style="color: #000000">  ANY_VALUE(</span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">0</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> vendor_count__0 </span><span style="color: #0000FF">END</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> vendor_count,</span></span>
<span class="line"><span style="color: #000000">  ANY_VALUE(</span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">0</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> total_sale_dollars__0 </span><span style="color: #0000FF">END</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> total_sale_dollars,</span></span>
<span class="line"><span style="color: #000000">  ANY_VALUE(</span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">0</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> total_bottles__0 </span><span style="color: #0000FF">END</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> total_bottles,</span></span>
<span class="line"><span style="color: #000000">  ARRAY_AGG(</span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> STRUCT(</span></span>
<span class="line"><span style="color: #000000">    vendor_name__1 </span><span style="color: #0000FF">as</span><span style="color: #000000"> vendor_name, </span></span>
<span class="line"><span style="color: #000000">    item_description__1 </span><span style="color: #0000FF">as</span><span style="color: #000000"> item_description, </span></span>
<span class="line"><span style="color: #000000">    total_sale_dollars__1 </span><span style="color: #0000FF">as</span><span style="color: #000000"> total_sale_dollars, </span></span>
<span class="line"><span style="color: #000000">    total_bottles__1 </span><span style="color: #0000FF">as</span><span style="color: #000000"> total_bottles, </span></span>
<span class="line"><span style="color: #000000">    avg_price_per_100ml__1 </span><span style="color: #0000FF">as</span><span style="color: #000000"> avg_price_per_100ml, </span></span>
<span class="line"><span style="color: #000000">    percent_of_sales__1 </span><span style="color: #0000FF">as</span><span style="color: #000000"> percent_of_sales</span></span>
<span class="line"><span style="color: #000000">    ) </span><span style="color: #0000FF">END</span><span style="color: #000000"> IGNORE NULLS  </span><span style="color: #0000FF">ORDER BY</span><span style="color: #000000">  total_sale_dollars__1 </span><span style="color: #0000FF">desc</span><span style="color: #000000">  </span><span style="color: #0000FF">LIMIT</span><span style="color: #000000"> </span><span style="color: #098658">5</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> top_sellers_by_revenue</span></span>
<span class="line"><span style="color: #0000FF">FROM</span><span style="color: #000000"> __stage0</span></span>
<span class="line"><span style="color: #0000FF">ORDER BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">desc</span></span>
<span class="line"></span></pre></pre>
      </div>
    </div>
  </div></div></div>
        </div>
        <script src="/malloy/js/view_toggles.js"></script>
      </div>
    </div>
    <div id="banner_wrapper">
  <div id="banner">
    <div>
      This site uses cookies from Google to deliver its services and to analyze
      traffic.
      <a
        href="https://policies.google.com/technologies/cookies"
        target="_blank"
      >
        Learn more
      </a>
    </div>
    <button id="banner_button">I Understand</button>
  </div>
</div>

    <script src="/malloy/js/banner.js"></script>
  </body>
</html>
